## 问题定位
用户提供的日志指出了两个核心问题：
1.  **数据库错误 (`PGRST205`)**: `logAction` 函数尝试向 `experiment_logs` 表插入数据时失败，提示找不到表。这通常是因为 Supabase 的 schema 缓存未刷新，或者在 Storybook 环境下连接了错误的数据库实例（或未连接）。
2.  **R3F 渲染错误**: `BiologyLab.tsx` 中使用了 `ellipsoidGeometry`，但这不是 Three.js 的原生几何体，也不是 `@react-three/drei` 自动导出的组件。这导致 React Three Fiber (R3F) 渲染崩溃。

## 解决方案

### 1. 修复 R3F 渲染错误
*   **替换几何体**: `ellipsoidGeometry` 并非标准 Three.js 几何体。应使用 `SphereGeometry` 并通过 `scale` 属性将其压扁成椭球体。
    *   原代码: `<ellipsoidGeometry args={[0.3, 0.05, 0.15]} />`
    *   修正: `<sphereGeometry args={[1, 16, 16]} />` 配合 `scale={[0.3, 0.05, 0.15]}`。

### 2. 修复数据库日志错误
*   **Schema 刷新**: 确保 `experiment_logs` 表已在 Supabase 中正确创建。根据之前的迁移文件，该表应该存在。错误可能是由于 Storybook 运行在隔离环境中，环境变量未正确加载。
*   **环境模拟**: 在 Storybook 中，需要确保 `logAction` 能够优雅降级。如果无法连接 Supabase（如在 CI 或纯前端演示中），应只记录到控制台而不抛出错误，或使用 Mock 数据。
*   **代码健壮性**: 修改 `logAction`，添加 try-catch 块，并在开发环境/无网络环境下跳过真实数据库写入。

### 3. 全面完善与交付
*   **依赖检查**: 确认 `package.json` 中是否缺失 `three-stdlib` 或其他可能需要的库（虽然本次修复不依赖它）。
*   **测试覆盖**: 编写 `BiologyLab.test.tsx` 和 `PhysicsLab.test.tsx`，模拟用户交互。
*   **文档与脚本**: 编写 `DEPLOY.md` 和启动脚本，确保“一键复现”。

## 实施步骤
1.  **代码修复**:
    *   修改 `BiologyLab.tsx`，将 `ellipsoidGeometry` 替换为 `sphereGeometry` + `scale`。
    *   修改 `GradingSystem.tsx`，增强 `logAction` 的错误处理，支持 Mock 模式。
2.  **测试验证**:
    *   运行 Storybook 验证生物实验是否不再崩溃。
    *   运行单元测试确保逻辑正确。
3.  **交付准备**:
    *   创建启动脚本与文档。
    *   打包更新后的组件。

## 交付物
*   修复后的 `BiologyLab.tsx` 和 `GradingSystem.tsx`。
*   新增的单元测试文件。
*   `start-lab.sh` 和 `DEPLOY.md`。